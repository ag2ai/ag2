---
title: Real-Time Voice Interactions with the WebSocket Audio Adapter
authors:
  - marklysze
  - sternakt
  - davorrunje
  - davorinrusevljan
tags: [Realtime API, Voice Agents, AI Tools]

---

<div class="blog-authors">
   <p class="authors">Authors:</p>
   <CardGroup cols={2}>
      <Card href="https://github.com/marklysze">
         <div class="col card">
         <div class="img-placeholder">
            <img noZoom src="https://github.com/marklysze.png" />
         </div>
         <div>
            <p class="name">Mark Sze</p>
            <p>Software Engineer at AG2.ai</p>
         </div>
      </div>
      </Card>
      <Card href="https://github.com/sternakt">
         <div class="col card">
         <div class="img-placeholder">
            <img noZoom src="https://github.com/sternakt.png" />
         </div>
         <div>
            <p class="name">Tvrtko Sternak</p>
            <p>Machine Learning Engineer at Airt</p>
         </div>
      </div>
      </Card>
      <Card href="https://github.com/davorrunje">
         <div class="col card">
         <div class="img-placeholder">
            <img noZoom src="https://github.com/davorrunje.png" />
         </div>
         <div>
            <p class="name">Davor Runje</p>
            <p>CTO at Airt</p>
         </div>
      </div>
      </Card>
      <Card href="https://github.com/davorinrusevljan">
         <div class="col card">
         <div class="img-placeholder">
            <img noZoom src="https://github.com/davorinrusevljan.png" />
         </div>
         <div>
            <p class="name">Davorin RuÅ¡evljan</p>
            <p>Developer</p>
         </div>
      </div>
      </Card>
   </CardGroup>
</div>

![Realtime agent communication over websocket](img/websocket_communication_diagram.png)

**TL;DR:**
- **Demo implementation**: Implement a website using websockets and communicate using voice with the [**`RealtimeAgent`**](/docs/reference/agentchat/realtime_agent/realtime_agent)
- **Introducing [**`WebSocketAudioAdapter`**](/docs/reference/agentchat/realtime_agent/websocket_audio_adapter#websocketaudioadapter)**: Stream audio directly from your browser using [WebSockets](https://fastapi.tiangolo.com/advanced/websockets/).
- **Simplified Development**: Connect to real-time agents quickly and effortlessly with minimal setup.

# **Realtime over WebSockets**

In our [previous blog post](/blog/2024-12-20-RealtimeAgent/index), we introduced a way to interact with the [**`RealtimeAgent`**](/docs/reference/agentchat/realtime_agent/realtime_agent) using [**`TwilioAudioAdapter`**](/docs/reference/agentchat/realtime_agent/twilio_audio_adapter#twilioaudioadapter). While effective, this approach required a setup-intensive process involving [Twilio](https://www.twilio.com/) integration, account configuration, number forwarding, and other complexities. Today, we're excited to introduce the[**`WebSocketAudioAdapter`**](/docs/reference/agentchat/realtime_agent/websocket_audio_adapter#websocketaudioadapter), a streamlined approach to real-time audio streaming directly via a web browser.

This post explores the features, benefits, and implementation of the [**`WebSocketAudioAdapter`**](/docs/reference/agentchat/realtime_agent/websocket_audio_adapter#websocketaudioadapter), showing how it transforms the way we connect with real-time agents.

## **Why We Built the [**`WebSocketAudioAdapter`**](/docs/reference/agentchat/realtime_agent/websocket_audio_adapter#websocketaudioadapter)**
### **Challenges with Existing Solutions**
Previously introduced [**`TwilioAudioAdapter`**](/docs/reference/agentchat/realtime_agent/twilio_audio_adapter#twilioaudioadapter) provides a robust way to cennect to your [**`RealtimeAgent`**](/docs/reference/agentchat/realtime_agent/realtime_agent), it comes with challenges:
- **Browser Limitations**: For teams building web-first applications, integrating with a telephony platform can feel redundant.
- **Complex Setup**: Configuring Twilio accounts, verifying numbers, and setting up forwarding can be time-consuming.
- **Platform Dependency**: This solution requires developers to rely on external API, which adds latency and costs.

### **Our Solution**
The [**`WebSocketAudioAdapter`**](/docs/reference/agentchat/realtime_agent/websocket_audio_adapter#websocketaudioadapter) eliminates these challenges by allowing direct audio streaming over [WebSockets](https://fastapi.tiangolo.com/advanced/websockets/). It integrates seamlessly with modern web technologies, enabling real-time voice interactions without external telephony platforms.

## **How It Works**
At its core, the [**`WebSocketAudioAdapter`**](/docs/reference/agentchat/realtime_agent/websocket_audio_adapter#websocketaudioadapter) leverages [WebSockets](https://fastapi.tiangolo.com/advanced/websockets/) to handle real-time audio streaming. This means your browser becomes the communication bridge, sending audio packets to a server where a [**`RealtimeAgent`**](/docs/reference/agentchat/realtime_agent/realtime_agent) agent processes them.

Hereâ€™s a quick overview of its components and how they fit together:

1. **WebSocket Connection**:
   - The adapter establishes a [WebSockets](https://fastapi.tiangolo.com/advanced/websockets/) connection between the client (browser) and the server.
   - Audio packets are streamed in real time through this connection.

2. **Integration with FastAPI**:
   - Using Python's [FastAPI](https://fastapi.tiangolo.com/) framework, developers can easily set up endpoints for handling  [WebSockets](https://fastapi.tiangolo.com/advanced/websockets/) traffic.

3. **Powered by Realtime Agents**:
   - The audio adapter integrates with an AI-powered [**`RealtimeAgent`**](/docs/reference/agentchat/realtime_agent/realtime_agent), allowing the agent to process audio inputs and respond intelligently.

## **Key Features**
### **1. Simplified Setup**
Unlike [**`TwilioAudioAdapter`**](/docs/reference/agentchat/realtime_agent/twilio_audio_adapter#twilioaudioadapter), the [**`WebSocketAudioAdapter`**](/docs/reference/agentchat/realtime_agent/websocket_audio_adapter#websocketaudioadapter) requires no phone numbers, no telephony configuration, and no external accounts. It's a plug-and-play solution.

### **2. Real-Time Performance**
By streaming audio over [WebSockets](https://fastapi.tiangolo.com/advanced/websockets/), the adapter ensures low latency, making conversations feel natural and seamless.

### **3. Browser-Based**
Everything happens within the user's browser, meaning no additional software is required. This makes it ideal for web applications.

### **4. Flexible Integration**
Whether you're building a chatbot, a voice assistant, or an interactive application, the adapter can integrate easily with existing frameworks and AI systems.

## **Example: Build a Voice-Enabled Weather Bot**
Letâ€™s walk through a practical example where we use the [**`WebSocketAudioAdapter`**](/docs/reference/agentchat/realtime_agent/websocket_audio_adapter#websocketaudioadapter) to create a voice-enabled weather bot.
The full example is in [this notebook](/notebooks/agentchat_realtime_websocket), you can run it locally by cloning the AG2 repo and executing the notebook.

### **Step 1: Set Up the Server**
We use [FastAPI](https://fastapi.tiangolo.com/) to serve the chat interface and handle WebSocket connections. A key part is configuring the server to load and render HTML templates dynamically for the user interface.

- **Template Loading**: Use `Jinja2Templates` to load `chat.html` from the `templates` directory. The template is dynamically rendered with variables like the server's `port`.
- **Static Files**: Serve assets (e.g., JavaScript, CSS) from the `static` directory.

```python
from fastapi import FastAPI, WebSocket
from fastapi.responses import HTMLResponse, JSONResponse
from fastapi.staticfiles import StaticFiles
from fastapi.templating import Jinja2Templates
import uvicorn
from pathlib import Path

app = FastAPI()
PORT = 5050
notebook_path = Path.cwd()

app.mount("/static", StaticFiles(directory=notebook_path / "static"), name="static")
templates = Jinja2Templates(directory=notebook_path / "templates")

@app.get("/", response_class=JSONResponse)
async def index_page():
    return {"message": "WebSocket Audio Stream Server is running!"}

@app.get("/start-chat/", response_class=HTMLResponse)
async def start_chat(request):
    return templates.TemplateResponse("chat.html", {"request": request, "port": PORT})
```

### **Step 2: Define the WebSocket Endpoint**
Next, we create the `/media-stream` WebSocket route. This is where the real-time magic happens.

```python
@app.websocket("/media-stream")
async def handle_media_stream(websocket: WebSocket):
    await websocket.accept()
    audio_adapter = WebSocketAudioAdapter(websocket)
    realtime_agent = RealtimeAgent(
        name="Weather Bot",
        system_message="Hi! I can tell you the weather. Ask me anything.",
        audio_adapter=audio_adapter
    )

    @realtime_agent.register_realtime_function(name="get_weather", description="Provides weather information.")
    def get_weather(location: str) -> str:
        return "The weather is sunny." if location.lower() != "seattle" else "The weather is cloudy."

    await realtime_agent.run()
```

### **Step 3: Run the Server**
Start the server using Uvicorn:
```bash
uvicorn app:app --host 0.0.0.0 --port 5050
```

After you start the server you should your application running in the logs:

```bash
INFO:     Started server process [64425]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:5050 (Press CTRL+C to quit)
```

### Ready to Chat? ðŸš€
Now you can simply open [**localhost:5050/start-chat**](http://localhost:5050/start-chat) in your browser, and dive into an interactive conversation with the RealtimeAgent! ðŸŽ¤âœ¨

## **Benefits in Action**
- **Quick Prototyping**: Spin up a real-time voice application in minutes.
- **Cost Efficiency**: Eliminate third-party telephony costs.
- **User-Friendly**: Runs in the browser, making it accessible to anyone with a microphone.

## **Conclusion**
The [**`WebSocketAudioAdapter`**](/docs/reference/agentchat/realtime_agent/websocket_audio_adapter#websocketaudioadapter) marks a shift toward simpler, more accessible real-time audio solutions. It empowers developers to build and deploy voice applications faster and more efficiently. Whether you're creating an AI assistant, a voice-enabled app, or an experimental project, this adapter is your go-to tool for real-time audio streaming.

Try it out and bring your voice-enabled ideas to life!
