---
title: Python Local Code Execution
sidebarTitle: Code Execution
---

Add code execution as a capability for your AG2 agents with the [`PythonLocalExecutionTool`](/docs/api-reference/autogen/tools/experimental/PythonLocalExecutionTool)! Utilizing your local Python environment, whether that's the system one or a virtual one, your agents can generate, run and utilize the results of Python code.

The ability to execute code enables your agents to not only create code for applications but also to validate hypotheses, validate existing code, and cycle through code iterations until a working solution can be found.

<Warning>
Executing code, particularly code generated by an LLM, has inherent risks and this tool will run the code in the current environment.

Even if using the virtual environment option, code is still executing within the operating system.

If you are running your application in a container (e.g. Docker), that provides some isolation from the outside operating system.
</Warning>

The [`PythonLocalExecutionTool`](/docs/api-reference/autogen/tools/experimental/PythonLocalExecutionTool) is comprised of a Python environment and a working directory, both of which you need to specity.

<Tip>
If you want to run the code in a container, a Docker-based code execution tool would be preferred. If you would like to develop one, we'd love your contribution! Please see our [Contributor Guide](https://docs.ag2.ai/docs/contributor-guide/contributing).
</Tip>

## Installation

No additional extras/packages are required and this tool will work for Mac, Windows, and Linux.

You will need to have the Python versions you want to run installed. The tool will not install a specific Python version for you.

## Environments

There are two local environments the tool can can run the code in:
1. System Environment - this is equivalent to your terminal or command prompt, and utilizes the Python interpreter (version) available by default at your system-level.
2. Virtual Environment (venv) - utilising Python's virtual environment capabilities, this has its own independent set of Python packages.

You create and pass these in using the `python_environment` parameter of the [`PythonLocalExecutionTool`](/docs/api-reference/autogen/tools/experimental/PythonLocalExecutionTool).

<Tip>
It is highly advisable to use the Virtual Environment as it provides package isolation from your system packages.
</Tip>

### System Environment

The [`SystemPythonEnvironment`](/docs/api-reference/autogen/environments/SystemPythonEnvironment) uses the operating system's Python environment. It allows you to run code with all the installed packages.

There is only one, optional, parameter for the [`SystemPythonEnvironment`](/docs/api-reference/autogen/environments/SystemPythonEnvironment) and that's `executable` which can be a path (including filename) to the Python executable. This is useful if you have multiple Python interpreters installed and want to execute the code with a specific Python one.

### Venv Environment

The [`VenvPythonEnvironment`](/docs/api-reference/autogen/environments/VenvPythonEnvironment) uses or creates a virtual environment to run the code in. This provides package isolation from the operating system Python environment and is the preferred environment for this tool.

The parameters for the [`VenvPythonEnvironment`](/docs/api-reference/autogen/environments/VenvPythonEnvironment) allow you to use existing, or create new, virtual environments.

| Parameter | Description |
| --- | --- |
| `python_version` | If you do not specify a `python_path` or a `venv_path` with an existing virtual environment, a virtual environment with the specified Python version will be created. The Python version must already exist, it will not be installed. |
| `python_path` | If you want to use a specific Python interpreter you can pass in the path (and filename) of it. This takes precedence over the `python_version`, but will not be used if the `venv_path` is provided and a virtual environment already exists. |
| `venv_path` | If you want to use an existing virtual environment or want a new one to be created in a specific location, you can specify a path for it. | 

<Tip>
If you pass in a `python_version` the tool will look for the Python interpreter executable in typical locations on disk. However, if yours is installed elsewhere you will need to use the `python_path` to specify the correct location.
</Tip>

Note: The virtual environment directory will not be removed by the tool.

## Working Directory

The tool will create a `scripts.py` file with the code and execute it. The location of this file is specified by passing in a [`WorkingDirectory`](/docs/api-reference/autogen/environments/WorkingDirectory) to the `working_directory` parameter of the [`PythonLocalExecutionTool`](/docs/api-reference/autogen/tools/experimental/PythonLocalExecutionTool).

If you don't want to specify a directory you can use [`WorkingDirectory`](/docs/api-reference/autogen/environments/WorkingDirectory)'s `create_tmp` method to create a temporary one.

Note: The working directory will not be removed by the tool.

## Timeout

To assist in handling execution that runs beyond a reasonable amount of time, a `timeout` parameter (in seconds) is provided. The default timeout is 30 seconds.

## Packages

Packages are not installed if the code depends on them and they are missing.

If you are expecting packages to be required, create a virtual environment and install the packages within that virtual environment, then point the [`VenvPythonEnvironment`](/docs/api-reference/autogen/environments/VenvPythonEnvironment) environment to that using its `venv_path` parameter.

## Examples

### System Environment

import CodeExecutionLocalSystem from "/snippets/reference-tools/code-execution-local-system.mdx";

<CodeExecutionLocalSystem/>

### Venv Environment

import CodeExecutionLocalVenv from "/snippets/reference-tools/code-execution-local-venv.mdx";

<CodeExecutionLocalVenv/>